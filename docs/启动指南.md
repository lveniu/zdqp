# 整点抢券 - 启动指南

## 🚀 快速启动

### 方式一：双击启动（推荐）

直接双击 **启动.bat** 文件

- 后端服务将在当前窗口运行
- 所有日志输出都会显示在窗口中
- 按 Ctrl+C 可以停止服务

### 方式二：分别启动

**启动后端:**
- 双击 `start_backend.bat`
- 后端运行在 http://localhost:8000

**启动前端:**
- 双击 `start_frontend.bat`
- 前端自动运行在 http://localhost:5173 (或自动分配端口)

### 方式三：一键启动全部

双击 `start_all.bat`
- 自动启动后端和前端
- 每个服务在独立窗口运行
- 可分别查看日志

## 🌐 访问地址

- **前端界面**: http://localhost:5173
- **后端API**: http://localhost:8000
- **API文档**: http://localhost:8000/docs

## 🔑 使用方法

1. 打开前端界面
2. 在左侧"Cookie配置"区域输入拼多多Cookie
3. 点击"🔄 加载数据"按钮
4. 开始使用打卡和抢券功能

## 📝 获取Cookie

1. 打开 https://mobile.yangkeduo.com/
2. 登录账号
3. 按F12打开开发者工具
4. 切换到Network标签
5. 刷新页面
6. 找到任意请求
7. 复制请求头中的Cookie值
8. 粘贴到系统输入框

## 🛑 停止服务

- 在服务窗口按 Ctrl+C
- 或直接关闭窗口

## ⚙️ 系统要求

- Python 3.8+
- Node.js 16+
- Windows 10+

## 📊 功能说明

- ✅ 每日打卡领积分
- ✅ 积分查询
- ✅ 自动抢5元券
- ✅ 历史记录查询
- ✅ 统计信息展示
- ✅ 多用户支持（通过Cookie自动识别）

## 🔧 故障排查

### 前端请求 API 返回 405 或连接失败

**原因**：前端代理配置与后端端口不匹配

**解决方案**：

1. **确保后端已启动**
   ```bash
   python start_web.py
   ```
   查看控制台输出的实际端口（例如：`后端API: http://localhost:8000`）

2. **如果端口不是默认的 8000**
   ```bash
   # Windows CMD
   set VITE_API_URL=http://localhost:实际端口
   npm run dev

   # Windows PowerShell
   $env:VITE_API_URL="http://localhost:实际端口"
   npm run dev

   # Linux/Mac
   VITE_API_URL=http://localhost:实际端口 npm run dev
   ```

3. **或者修改 Vite 配置文件**
   编辑 `web/vite.config.js`，将 `target` 改为实际端口

### 端口被占用

**问题**：启动时提示端口被占用

**解决方案**：
```bash
# Windows - 查找占用端口的进程
netstat -ano | findstr :8000

# 结束进程
taskkill /PID 进程ID /F

# 或者使用停止脚本
scripts\stop.bat
```

### 依赖安装失败

**问题**：模块未找到

**解决方案**：
```bash
# 安装 Python 依赖
pip install fastapi uvicorn sqlalchemy pydantic httpx loguru rich

# 安装前端依赖
cd web
npm install
```

### 无法加载状态

**问题**：点击按钮后没有反应或返回错误

**解决方案**：
1. 检查 Cookie 是否正确（确保包含 PDDAccessToken）
2. 打开浏览器开发者工具（F12）查看控制台错误
3. 查看后端窗口的日志输出
4. 检查 `logs/error.log` 日志文件

## 📞 技术支持

- 查看后端窗口日志
- 浏览器F12查看控制台
- 检查 `logs/api.log` 日志文件
